0
ADD
24
XXXXXXXXXXXXXXXXXXX
if a(v24) and v30<>&uf('DRDR,!RI=',v30,'!,v30') then &uf('DRDR,!RI=',v30,'!,v30') fi
XXXXXXXXXXXXXXXXXXX
IF
if &unifor('D',v1,',?I='v903,'?,@free_ekz_filed')<>'' and a(v999) then '1' fi 
XXXXXXXXXXXXXXXXXXX
XXXXXXXXXXXXXXXXXXX
XXXXXXXXXXXXXXXXXXX
//
XXXXXXXXXXXXXXXXXXX
XXXXXXXXXXXXXXXXXXX
Выполнять только при создании заказа для номеров, имеющих подшитые экземпляры

ADD
999
XXXXXXXXXXXXXXXXXXX
'999'
XXXXXXXXXXXXXXXXXXX
ADD
9031
XXXXXXXXXXXXXXXXXXX
&unifor('D',v1,',?I='v903,'?,@free_ekz_filed')
XXXXXXXXXXXXXXXXXXX
//
XXXXXXXXXXXXXXXXXXX
XXXXXXXXXXXXXXXXXXX
Добавить шифры свободных подшивок

ADD
9032
XXXXXXXXXXXXXXXXXXX
&unifor('D',v1,',?I='v903,'?,@free_ekz_not_filed')
XXXXXXXXXXXXXXXXXXX
//
XXXXXXXXXXXXXXXXXXX
XXXXXXXXXXXXXXXXXXX
Добавить признак наличия свободных неподшитых номеров

IF
if p(v9031) and (not v9031:v903) then '1' fi
XXXXXXXXXXXXXXXXXXX
XXXXXXXXXXXXXXXXXXX
XXXXXXXXXXXXXXXXXXX
//
XXXXXXXXXXXXXXXXXXX
XXXXXXXXXXXXXXXXXXX
Выполнять не для подшивок

IF
if p(v9031) and a(v9032) then '1' fi 
XXXXXXXXXXXXXXXXXXX
XXXXXXXXXXXXXXXXXXX
XXXXXXXXXXXXXXXXXXX
//
XXXXXXXXXXXXXXXXXXX
XXXXXXXXXXXXXXXXXXX
Если все свободные номера подшиты

REP
903

&uf('Av9031#1')
XXXXXXXXXXXXXXXXXXX
DEL
9031
1
XXXXXXXXXXXXXXXXXXX
XXXXXXXXXXXXXXXXXXX
FI
XXXXXXXXXXXXXXXXXXX
XXXXXXXXXXXXXXXXXXX
XXXXXXXXXXXXXXXXXXX
XXXXXXXXXXXXXXXXXXX
IF
if p(v9032) or p(v9031) then '1' fi 
XXXXXXXXXXXXXXXXXXX
XXXXXXXXXXXXXXXXXXX
XXXXXXXXXXXXXXXXXXX
//
XXXXXXXXXXXXXXXXXXX
XXXXXXXXXXXXXXXXXXX
Если есть свободные неподшитые номера или несколько номеров, подшитых в разные подшивки, создать дополнительный заказ на подшивку

REPEAT
XXXXXXXXXXXXXXXXXXX
XXXXXXXXXXXXXXXXXXX
XXXXXXXXXXXXXXXXXXX
XXXXXXXXXXXXXXXXXXX
NEWMFN
'*'
XXXXXXXXXXXXXXXXXXX
XXXXXXXXXXXXXXXXXXX
XXXXXXXXXXXXXXXXXXX
ALL
XXXXXXXXXXXXXXXXXXX
XXXXXXXXXXXXXXXXXXX
XXXXXXXXXXXXXXXXXXX
XXXXXXXXXXXXXXXXXXX
REP
903

&uf('Av9031#1')
XXXXXXXXXXXXXXXXXXX
DEL
9031
*
XXXXXXXXXXXXXXXXXXX
XXXXXXXXXXXXXXXXXXX
END
XXXXXXXXXXXXXXXXXXX
XXXXXXXXXXXXXXXXXXX
XXXXXXXXXXXXXXXXXXX
XXXXXXXXXXXXXXXXXXX
DEL
9031
1
XXXXXXXXXXXXXXXXXXX
XXXXXXXXXXXXXXXXXXX
DEL
9032
1
XXXXXXXXXXXXXXXXXXX
XXXXXXXXXXXXXXXXXXX
UNTIL
if s(v9031,v9032)<>'' then '1' else '0' fi
XXXXXXXXXXXXXXXXXXX
XXXXXXXXXXXXXXXXXXX
XXXXXXXXXXXXXXXXXXX
FI
XXXXXXXXXXXXXXXXXXX
XXXXXXXXXXXXXXXXXXX
XXXXXXXXXXXXXXXXXXX
XXXXXXXXXXXXXXXXXXX
FI
XXXXXXXXXXXXXXXXXXX
XXXXXXXXXXXXXXXXXXX
XXXXXXXXXXXXXXXXXXX
XXXXXXXXXXXXXXXXXXX
FI
XXXXXXXXXXXXXXXXXXX
XXXXXXXXXXXXXXXXXXX
XXXXXXXXXXXXXXXXXXX
XXXXXXXXXXXXXXXXXXX
