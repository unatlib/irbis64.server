1
DelArh.wss
Задание даты, признака архивации
//
XXXXXXXXXXXXXXXXXXX
XXXXXXXXXXXXXXXXXXX
 991^A - если дата возврата меньше/равна заданного значения

//
XXXXXXXXXXXXXXXXXXX
XXXXXXXXXXXXXXXXXXX
 991^B - признак переноса в архив 

DEL
991
*
XXXXXXXXXXXXXXXXXXX
XXXXXXXXXXXXXXXXXXX
ADD
991
XXXXXXXXXXXXXXXXXXX
'%1',,,&uf('+7W10#')
XXXXXXXXXXXXXXXXXXX
DEL
1040
*
XXXXXXXXXXXXXXXXXXX
XXXXXXXXXXXXXXXXXXX
IF
if val(v991^B)=1 then '1' fi
XXXXXXXXXXXXXXXXXXX
XXXXXXXXXXXXXXXXXXX
XXXXXXXXXXXXXXXXXXX
ADD
1040
XXXXXXXXXXXXXXXXXXX
(if p(v40) then if v40^F<>'' and v40^F<>'' and v40^F<>'******' and val(v40^F)<=val(&uf('Av991^A#1')) then v40 fi fi/)
XXXXXXXXXXXXXXXXXXX
FI
XXXXXXXXXXXXXXXXXXX
XXXXXXXXXXXXXXXXXXX
XXXXXXXXXXXXXXXXXXX
XXXXXXXXXXXXXXXXXXX
DEL
40
F
(if p(v40) then if v40^F<>'' and v40^F<>'' and v40^F<>'******' and val(v40^F)<=val(&uf('Av991^A#1')) then '1' else '0' fi fi/)
XXXXXXXXXXXXXXXXXXX
IF
if p(v1040) then '1'&uf('S0'),&uf('+7W1#'&uf('+N1040')) fi
XXXXXXXXXXXXXXXXXXX
XXXXXXXXXXXXXXXXXXX
XXXXXXXXXXXXXXXXXXX
//
XXXXXXXXXXXXXXXXXXX
XXXXXXXXXXXXXXXXXXX
------создание записей в архивной БД

REPEAT
XXXXXXXXXXXXXXXXXXX
XXXXXXXXXXXXXXXXXXX
XXXXXXXXXXXXXXXXXXX
XXXXXXXXXXXXXXXXXXX
NEWMFN
'RDR_ARH'
XXXXXXXXXXXXXXXXXXX
XXXXXXXXXXXXXXXXXXX
XXXXXXXXXXXXXXXXXXX
ADD
30
XXXXXXXXXXXXXXXXXXX
v30
XXXXXXXXXXXXXXXXXXX
ADD
40
XXXXXXXXXXXXXXXXXXX
&uf('Av1040#'&uf('S1A'))
XXXXXXXXXXXXXXXXXXX
PUTLOG
'Создана запись в БД ',,&uf('+D')
XXXXXXXXXXXXXXXXXXX
XXXXXXXXXXXXXXXXXXX
XXXXXXXXXXXXXXXXXXX
END
XXXXXXXXXXXXXXXXXXX
XXXXXXXXXXXXXXXXXXX
XXXXXXXXXXXXXXXXXXX
XXXXXXXXXXXXXXXXXXX
UNTIL
if val(&uf('SA'))< val(g1) then '1' fi
XXXXXXXXXXXXXXXXXXX
XXXXXXXXXXXXXXXXXXX
XXXXXXXXXXXXXXXXXXX
FI
XXXXXXXXXXXXXXXXXXX
XXXXXXXXXXXXXXXXXXX
XXXXXXXXXXXXXXXXXXX
XXXXXXXXXXXXXXXXXXX
DEL
991
*
XXXXXXXXXXXXXXXXXXX
XXXXXXXXXXXXXXXXXXX
DEL
1040
*
XXXXXXXXXXXXXXXXXXX
XXXXXXXXXXXXXXXXXXX
