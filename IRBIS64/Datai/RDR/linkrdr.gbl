0
//12 PUTLOG 
//10.1 учет разницы специальность-направление, учет DefaultModeSpec при добавлении 69
//9.1 - с учетом групп
//формирование заново полей 69
// для повтор-ся поля 90
// сначала поля 69 без условия отчисленя, потом снимаю для отчисленных по 
// признаку отчисления по факультетам фак-м
// запоминаю поля 69 в 1069 и в 1070
DEL
1069
*
XXXXXXXXXXXXXXXXXXX
XXXXXXXXXXXXXXXXXXX
ADD
1069
XXXXXXXXXXXXXXXXXXX
(v69/)
XXXXXXXXXXXXXXXXXXX
DEL
1070
*
XXXXXXXXXXXXXXXXXXX
XXXXXXXXXXXXXXXXXXX
ADD
1070
XXXXXXXXXXXXXXXXXXX
(v69/)
XXXXXXXXXXXXXXXXXXX
// формирование заново поля 69
DEL
69
*
XXXXXXXXXXXXXXXXXXX
XXXXXXXXXXXXXXXXXXX
// надстройка - учет повторяемости поля 90
DEL
1009
*
XXXXXXXXXXXXXXXXXXX
XXXXXXXXXXXXXXXXXXX
ADD
1009
XXXXXXXXXXXXXXXXXXX
(v90/)
XXXXXXXXXXXXXXXXXXX
DEL
1010
*
XXXXXXXXXXXXXXXXXXX
XXXXXXXXXXXXXXXXXXX
ADD
1010
XXXXXXXXXXXXXXXXXXX
(v90/),,,&uf('+7W12#')
XXXXXXXXXXXXXXXXXXX
//.............цикл по повторениям поля 90

REPEAT
XXXXXXXXXXXXXXXXXXX
XXXXXXXXXXXXXXXXXXX
XXXXXXXXXXXXXXXXXXX
XXXXXXXXXXXXXXXXXXX
DEL
90
*
XXXXXXXXXXXXXXXXXXX
XXXXXXXXXXXXXXXXXXX
ADD
90
XXXXXXXXXXXXXXXXXXX
&uf('Av1009#1')
XXXXXXXXXXXXXXXXXXX
// сначала в 115, чтобы  не повторять подполя B и D

DEL
115
*
XXXXXXXXXXXXXXXXXXX
XXXXXXXXXXXXXXXXXXX
// точное совпадение специальностей при любом DefaultModeSpec
ADD
115
XXXXXXXXXXXXXXXXXXX
if p(v90)  then  if val(&uf('IMAIN,LinkGroup,0'))=1 then if v90^E<>'' then  &unifor('7VUZ,?VGR=',,v90^E,,,'?,(v69/)') fi else if &unifor('JVUZ,?',v90^a"-",,v90^n"-",v90^c"-" ,v90^v"-",v90^o"-",v90^f"-")>'0' then &uf('+7U12#',&unifor('7VUZ,!?',v90^a"-",,v90^n"-",v90^c"-" ,v90^v"-",v90^o"-",v90^f"-",,'!,@6869')) fi,,,,,,,,,,,,,,,,,,,if &unifor('JVUZ,?',v90^a"-",,v90^n"-",v90^c"-" ,v90^o"-",v90^f"-")>'0' then &uf('+7U12#',&unifor('7VUZ,!?',v90^a"-",,v90^n"-",v90^c"-" ,v90^o"-",v90^f"-",,'!,@6869')) fi,,,,,,,,,,,,,,,,,,if &unifor('JVUZ,?',,v90^a"-",,v90^n"-",,v90^c"-" ,v90^v"-",v90^f"-")>'0' then &uf('+7U12#',&unifor('7VUZ,!?',v90^a"-",,v90^n"-",v90^c"-" ,v90^v"-",v90^f"-",,'!,@6869')) fi,,,,,,,,,,,,,,,,,,if &unifor('JVUZ,?',v90^a"-",v90^n"-",,v90^v"-",,v90^o"-",v90^f"-")>'0' then &uf('+7U12#',&unifor('7VUZ,!?',v90^a"-",v90^n"-"v90^v"-",,v90^o"-",v90^f"-",,,'!,@6869')) fi,,,,,,,,,,,,,,,,,if &unifor('JVUZ,?',v90^a"-",v90^c"-",,v90^v"-",,v90^o"-",v90^f"-")>'0' then &uf('+7U12#',&unifor('7VUZ,!?',v90^a"-",v90^c"-"v90^v"-",,v90^o"-",v90^f"-",,'!,@6869')) fi,,,,,,,,,,,,,,,,,if &unifor('JVUZ,?',v90^a"-",,v90^v"-",,v90^o"-",v90^f"-")>'0' then &uf('+7U12#',&unifor('7VUZ,!?',,v90^a"-",,v90^v"-",,v90^o"-",v90^f"-",,'!,@6869')) fi,,,,,,,,,,,,,,,,if &unifor('JVUZ,?',v90^a"-",,v90^o"-",v90^f"-")>'0' then &uf('+7U12#',&unifor('7VUZ,!?',v90^a"-",,v90^o"-",v90^f"-",'!,@6869')) fi,,,,,,,,,,,,,,,,if &unifor('JVUZ,?',v90^a"-",,v90^v"-",,v90^f"-")>'0' then &uf('+7U12#',&unifor('7VUZ,!?',,v90^a"-",,v90^v"-",,v90^f"-",,'!,@6869')) fi,,,,,,,,,,,,,,,,if &unifor('JVUZ,?',v90^a"-",,,v90^f"-",,)>'0' then &uf('+7U12#',&unifor('7VUZ,!?',,v90^a"-",,,v90^f"-",,'!,@6869')) fi,,,,,,,,,,,,,,,if &unifor('JVUZ,?',v90^v"-",,v90^o"-",v90^f"-",)>'0' then &uf('+7U12#',&unifor('7VUZ,!?',,v90^v"-",,v90^o"-",v90^f"-",,'!,@6869')) fi,,,,,,,,,,,,,,,,if &unifor('JVUZ,?',v90^v"-",,,v90^f"-",,)>'0' then &uf('+7U12#',&unifor('7VUZ,!?',,v90^v"-",,v90^f"-",,'!,@6869')) fi,,,,,,,,,,,,,,if &unifor('JVUZ,?',v90^o"-",v90^f"-",)>'0' then &uf('+7U12#',&unifor('7VUZ,!?',,v90^o"-",v90^f"-",,'!,@6869')) fi,,,,,,,,,,,,,,if &unifor('JVUZ,?',,v90^f"-",)>'0' then &uf('+7U12#',&unifor('7VUZ,!?',,,v90^f"-",,'!,@6869')) fi,,,,,,,,,,,,,,fi fi
XXXXXXXXXXXXXXXXXXX
IF
if &uf('IMAIN,DefaultModeSpec,1')='1' or &uf('IMAIN,DefaultModeSpec,1')='' then '1' fi
// если в специальности есть точка, то беру специальность до точки 
DEL
1090
*
XXXXXXXXXXXXXXXXXXX
XXXXXXXXXXXXXXXXXXX
ADD
1090
XXXXXXXXXXXXXXXXXXX
v90
XXXXXXXXXXXXXXXXXXX
REP
1090^C
1
&uf('G0.',v1090^C)
XXXXXXXXXXXXXXXXXXX
ADD
115
XXXXXXXXXXXXXXXXXXX
if p(v1090)  then  if val(&uf('IMAIN,LinkGroup,0'))=1 then if v1090^E<>'' then  &unifor('7VUZ,?VGR=',,v1090^E,,,'?,(v69/)') fi else if &unifor('JVUZ,?',v1090^a"-",,v1090^n"-",v1090^c"-" ,v1090^v"-",v1090^o"-",v1090^f"-")>'0' then &uf('+7U12#',&unifor('7VUZ,!?',v1090^a"-",,v1090^n"-",v1090^c"-" ,v1090^v"-",v1090^o"-",v1090^f"-",,'!,@6869')) fi,,,,,,,,,,,,,,,,,,,if &unifor('JVUZ,?',v1090^a"-",,v1090^n"-",v1090^c"-" ,v1090^o"-",v1090^f"-")>'0' then &uf('+7U12#',&unifor('7VUZ,!?',v1090^a"-",,v1090^n"-",v1090^c"-" ,v1090^o"-",v1090^f"-",,'!,@6869')) fi,,,,,,,,,,,,,,,,,,if &unifor('JVUZ,?',,v1090^a"-",,v1090^n"-",,v1090^c"-" ,v1090^v"-",v1090^f"-")>'0' then &uf('+7U12#',&unifor('7VUZ,!?',v1090^a"-",,v1090^n"-",v1090^c"-" ,v1090^v"-",v1090^f"-",,'!,@6869')) fi,,,,,,,,,,,,,,,,,,if &unifor('JVUZ,?',v1090^a"-",v1090^n"-",,v1090^v"-",,v1090^o"-",v1090^f"-")>'0' then &uf('+7U12#',&unifor('7VUZ,!?',v1090^a"-",v1090^n"-"v1090^v"-",,v1090^o"-",v1090^f"-",,,'!,@6869')) fi,,,,,,,,,,,,,,,,,if &unifor('JVUZ,?',v1090^a"-",v1090^c"-",,v1090^v"-",,v1090^o"-",v1090^f"-")>'0' then &uf('+7U12#',&unifor('7VUZ,!?',v1090^a"-",v1090^c"-"v1090^v"-",,v1090^o"-",v1090^f"-",,'!,@6869')) fi,,,,,,,,,,,,,,,,,if &unifor('JVUZ,?',v1090^a"-",,v1090^v"-",,v1090^o"-",v1090^f"-")>'0' then &uf('+7U12#',&unifor('7VUZ,!?',,v1090^a"-",,v1090^v"-",,v1090^o"-",v1090^f"-",,'!,@6869')) fi,,,,,,,,,,,,,,,,if &unifor('JVUZ,?',v1090^a"-",,v1090^o"-",v1090^f"-")>'0' then &uf('+7U12#',&unifor('7VUZ,!?',v1090^a"-",,v1090^o"-",v1090^f"-",'!,@6869')) fi,,,,,,,,,,,,,,,,if &unifor('JVUZ,?',v1090^a"-",,v1090^v"-",,v1090^f"-")>'0' then &uf('+7U12#',&unifor('7VUZ,!?',,v1090^a"-",,v1090^v"-",,v1090^f"-",,'!,@6869')) fi,,,,,,,,,,,,,,,,if &unifor('JVUZ,?',v1090^a"-",,,v1090^f"-",,)>'0' then &uf('+7U12#',&unifor('7VUZ,!?',,v1090^a"-",,,v1090^f"-",,'!,@6869')) fi,,,,,,,,,,,,,,,if &unifor('JVUZ,?',v1090^v"-",,v1090^o"-",v1090^f"-",)>'0' then &uf('+7U12#',&unifor('7VUZ,!?',,v1090^v"-",,v1090^o"-",v1090^f"-",,'!,@6869')) fi,,,,,,,,,,,,,,,,if &unifor('JVUZ,?',v1090^v"-",,,v1090^f"-",,)>'0' then &uf('+7U12#',&unifor('7VUZ,!?',,v1090^v"-",,v1090^f"-",,'!,@6869')) fi,,,,,,,,,,,,,,if &unifor('JVUZ,?',v1090^o"-",v1090^f"-",)>'0' then &uf('+7U12#',&unifor('7VUZ,!?',,v1090^o"-",v1090^f"-",,'!,@6869')) fi,,,,,,,,,,,,,,if &unifor('JVUZ,?',,v1090^f"-",)>'0' then &uf('+7U12#',&unifor('7VUZ,!?',,,v1090^f"-",,'!,@6869')) fi,,,,,,,,,,,,,,fi fi
XXXXXXXXXXXXXXXXXXX
FI
XXXXXXXXXXXXXXXXXXX
XXXXXXXXXXXXXXXXXXX
XXXXXXXXXXXXXXXXXXX
XXXXXXXXXXXXXXXXXXX
IF
if &uf('IMAIN,DefaultModeSpec,1')='2' then '1' fi
// если специальность кончается не на 00, то расширяю на 00
IF
if v90^C<>'' then if v90^C*4.1<>'0' or v90^C*5.1<>'0' then '1' fi fi
XXXXXXXXXXXXXXXXXXX
XXXXXXXXXXXXXXXXXXX
XXXXXXXXXXXXXXXXXXX
DEL
1090
*
XXXXXXXXXXXXXXXXXXX
XXXXXXXXXXXXXXXXXXX
ADD
1090
XXXXXXXXXXXXXXXXXXX
v90
XXXXXXXXXXXXXXXXXXX
REP
1090^C
1
v1090^C.4,'00'
XXXXXXXXXXXXXXXXXXX
ADD
115
XXXXXXXXXXXXXXXXXXX
if p(v1090)  then  if val(&uf('IMAIN,LinkGroup,0'))=1 then if v1090^E<>'' then  &unifor('7VUZ,?VGR=',,v1090^E,,,'?,(v69/)') fi else if &unifor('JVUZ,?',v1090^a"-",,v1090^n"-",v1090^c"-" ,v1090^v"-",v1090^o"-",v1090^f"-")>'0' then &uf('+7U12#',&unifor('7VUZ,!?',v1090^a"-",,v1090^n"-",v1090^c"-" ,v1090^v"-",v1090^o"-",v1090^f"-",,'!,@6869')) fi,,,,,,,,,,,,,,,,,,,if &unifor('JVUZ,?',v1090^a"-",,v1090^n"-",v1090^c"-" ,v1090^o"-",v1090^f"-")>'0' then &uf('+7U12#',&unifor('7VUZ,!?',v1090^a"-",,v1090^n"-",v1090^c"-" ,v1090^o"-",v1090^f"-",,'!,@6869')) fi,,,,,,,,,,,,,,,,,,if &unifor('JVUZ,?',,v1090^a"-",,v1090^n"-",,v1090^c"-" ,v1090^v"-",v1090^f"-")>'0' then &uf('+7U12#',&unifor('7VUZ,!?',v1090^a"-",,v1090^n"-",v1090^c"-" ,v1090^v"-",v1090^f"-",,'!,@6869')) fi,,,,,,,,,,,,,,,,,,if &unifor('JVUZ,?',v1090^a"-",v1090^n"-",,v1090^v"-",,v1090^o"-",v1090^f"-")>'0' then &uf('+7U12#',&unifor('7VUZ,!?',v1090^a"-",v1090^n"-"v1090^v"-",,v1090^o"-",v1090^f"-",,,'!,@6869')) fi,,,,,,,,,,,,,,,,,if &unifor('JVUZ,?',v1090^a"-",v1090^c"-",,v1090^v"-",,v1090^o"-",v1090^f"-")>'0' then &uf('+7U12#',&unifor('7VUZ,!?',v1090^a"-",v1090^c"-"v1090^v"-",,v1090^o"-",v1090^f"-",,'!,@6869')) fi,,,,,,,,,,,,,,,,,if &unifor('JVUZ,?',v1090^a"-",,v1090^v"-",,v1090^o"-",v1090^f"-")>'0' then &uf('+7U12#',&unifor('7VUZ,!?',,v1090^a"-",,v1090^v"-",,v1090^o"-",v1090^f"-",,'!,@6869')) fi,,,,,,,,,,,,,,,,if &unifor('JVUZ,?',v1090^a"-",,v1090^o"-",v1090^f"-")>'0' then &uf('+7U12#',&unifor('7VUZ,!?',v1090^a"-",,v1090^o"-",v1090^f"-",'!,@6869')) fi,,,,,,,,,,,,,,,,if &unifor('JVUZ,?',v1090^a"-",,v1090^v"-",,v1090^f"-")>'0' then &uf('+7U12#',&unifor('7VUZ,!?',,v1090^a"-",,v1090^v"-",,v1090^f"-",,'!,@6869')) fi,,,,,,,,,,,,,,,,if &unifor('JVUZ,?',v1090^a"-",,,v1090^f"-",,)>'0' then &uf('+7U12#',&unifor('7VUZ,!?',,v1090^a"-",,,v1090^f"-",,'!,@6869')) fi,,,,,,,,,,,,,,,if &unifor('JVUZ,?',v1090^v"-",,v1090^o"-",v1090^f"-",)>'0' then &uf('+7U12#',&unifor('7VUZ,!?',,v1090^v"-",,v1090^o"-",v1090^f"-",,'!,@6869')) fi,,,,,,,,,,,,,,,,if &unifor('JVUZ,?',v1090^v"-",,,v1090^f"-",,)>'0' then &uf('+7U12#',&unifor('7VUZ,!?',,v1090^v"-",,v1090^f"-",,'!,@6869')) fi,,,,,,,,,,,,,,if &unifor('JVUZ,?',v1090^o"-",v1090^f"-",)>'0' then &uf('+7U12#',&unifor('7VUZ,!?',,v1090^o"-",v1090^f"-",,'!,@6869')) fi,,,,,,,,,,,,,,if &unifor('JVUZ,?',,v1090^f"-",)>'0' then &uf('+7U12#',&unifor('7VUZ,!?',,,v1090^f"-",,'!,@6869')) fi,,,,,,,,,,,,,,fi fi
XXXXXXXXXXXXXXXXXXX
FI
XXXXXXXXXXXXXXXXXXX
XXXXXXXXXXXXXXXXXXX
XXXXXXXXXXXXXXXXXXX
XXXXXXXXXXXXXXXXXXX
FI
XXXXXXXXXXXXXXXXXXX
XXXXXXXXXXXXXXXXXXX
XXXXXXXXXXXXXXXXXXX
XXXXXXXXXXXXXXXXXXX
DEL
115
*


//--------------10.1
ADD
115

&uf('+7G12'),,(G12/)

REPEAT
XXXXXXXXXXXXXXXXXXX
XXXXXXXXXXXXXXXXXXX
XXXXXXXXXXXXXXXXXXX
XXXXXXXXXXXXXXXXXXX
ADD
69
XXXXXXXXXXXXXXXXXXX
if a(v69) OR ( &uf('+97',v90^A)= &uf('+97',&unifor('Av115^A#1')) or s(&unifor('Av115^A#1'))='' ) and ( &uf('+97',v90^N)= &uf('+97',&unifor('Av115^N#1')) or s(&unifor('Av115^N#1'))='' ) and  ( &uf('+97',v90^O)= &uf('+97',&unifor('Av115^O#1')) or s(&unifor('Av115^O#1'))='' ) and  ( &uf('+97',v90^V)= &uf('+97',&unifor('Av115^V#1')) or s(&unifor('Av115^V#1'))='' ) and ( val(v90^F)=val(&unifor('Av115^F#1'))  or s(&unifor('Av115^F#1'))='' ) then if ( &uf('IMAIN,DefaultModeSpec,1')='3' ) and  ( &uf('+97',v90^C)= &uf('+97',&unifor('Av115^C#1')) or s(&unifor('Av115^C#1'))='' ) OR  ( &uf('IMAIN,DefaultModeSpec,1')='2' ) and ( &uf('+97',v90^C.4)= &uf('+97',&unifor('Av115^C.4#1')) or s(&unifor('Av115^C#1'))='' ) OR  ( s(&unifor('Av115^C#1')): '.' and &uf('+97',v90^C)=&uf('+97',&unifor('Av115^C#1')) or &uf('G0.',&uf('+97',v90^C))=&uf('G0.',&uf('+97',&unifor('Av115^C#1'))) or s(&unifor('Av115^C#1'))='' ) then  if rsum((if p(v69) then if &uf('+97',v69^B)= &uf('+97',&unifor('Av115^B#1')) and &uf('+97',v69^D)= &uf('+97',&unifor('Av115^D#1')) then '1,' else '0,' fi fi))=0 then if &unifor('Av115^B#1')<>'' then '^B',&unifor('Av115^B#1') fi,,,if &unifor('Av115^D#1')<>'' then '^D',&unifor('Av115^D#1') fi,,,  fi fi fi
XXXXXXXXXXXXXXXXXXX
DEL
115
1
XXXXXXXXXXXXXXXXXXX
XXXXXXXXXXXXXXXXXXX
UNTIL
if p(v115) then '1' fi
XXXXXXXXXXXXXXXXXXX
XXXXXXXXXXXXXXXXXXX
XXXXXXXXXXXXXXXXXXX
DEL
1090
*
XXXXXXXXXXXXXXXXXXX
XXXXXXXXXXXXXXXXXXX
// Удаление 69 в соответствии с изучаемым языком
DEL
69
F
if v920:'VUZ' then else (if p(v69) then if v69^d:':' then if &unifor('Av26#1')<>'' then if &unifor('DRDR,@'mfn,',v26|, |'):&unifor('G2:'v69^d) then'0'else'1' fi else '1' fi else '0' fi fi/) fi
XXXXXXXXXXXXXXXXXXX
DEL
1009
1
XXXXXXXXXXXXXXXXXXX
XXXXXXXXXXXXXXXXXXX
UNTIL
if p(v1009) then '1' fi
XXXXXXXXXXXXXXXXXXX
XXXXXXXXXXXXXXXXXXX
XXXXXXXXXXXXXXXXXXX
//.............конец цикла по повторением поля 90
DEL
90
*
XXXXXXXXXXXXXXXXXXX
XXXXXXXXXXXXXXXXXXX
ADD
90
XXXXXXXXXXXXXXXXXXX
(v1010/)
XXXXXXXXXXXXXXXXXXX
DEL
1010
*
XXXXXXXXXXXXXXXXXXX
XXXXXXXXXXXXXXXXXXX
//проверка изменились ли поля 69
IF
if p(v69) and &uf('+97',v69)<>&uf('+97',v1069) then '1' else '0' fi
XXXXXXXXXXXXXXXXXXX
XXXXXXXXXXXXXXXXXXX
XXXXXXXXXXXXXXXXXXX
PUTLOG
'LinkRdr: Откорректирована запись студента (',v30,'). MFN=',f(val(mfn),0,0)
XXXXXXXXXXXXXXXXXXX
XXXXXXXXXXXXXXXXXXX
XXXXXXXXXXXXXXXXXXX
FI
XXXXXXXXXXXXXXXXXXX
XXXXXXXXXXXXXXXXXXX
XXXXXXXXXXXXXXXXXXX
XXXXXXXXXXXXXXXXXXX
IF
if a(v69) and &uf('+97',v69)<>&uf('+97',v1069) then '1' else '0' fi
XXXXXXXXXXXXXXXXXXX
XXXXXXXXXXXXXXXXXXX
XXXXXXXXXXXXXXXXXXX
PUTLOG
'LinkRdr: Удалены дисциплины в записи студента (',v30,'). MFN=',f(val(mfn),0,0)
XXXXXXXXXXXXXXXXXXX
XXXXXXXXXXXXXXXXXXX
XXXXXXXXXXXXXXXXXXX
FI
XXXXXXXXXXXXXXXXXXX
XXXXXXXXXXXXXXXXXXX
XXXXXXXXXXXXXXXXXXX
XXXXXXXXXXXXXXXXXXX
DEL
1069
*
XXXXXXXXXXXXXXXXXXX
XXXXXXXXXXXXXXXXXXX
//===================новое в 8.1====================
// удаляю признак отчисления ^21 в поле 90, если нет поля 54
IF
if a(v54) then '1' fi
XXXXXXXXXXXXXXXXXXX
XXXXXXXXXXXXXXXXXXX
XXXXXXXXXXXXXXXXXXX
DEL
90^2
*
XXXXXXXXXXXXXXXXXXX
XXXXXXXXXXXXXXXXXXX
FI
XXXXXXXXXXXXXXXXXXX
XXXXXXXXXXXXXXXXXXX
XXXXXXXXXXXXXXXXXXX
XXXXXXXXXXXXXXXXXXX
//формирую признак отчислен в поле 90, если есть поле 54
IF
if p(v54) then '1' fi
XXXXXXXXXXXXXXXXXXX
XXXXXXXXXXXXXXXXXXX
XXXXXXXXXXXXXXXXXXX
// случай одного места обучения
IF
if val(&uf('+N90'))=1 then '1' fi
XXXXXXXXXXXXXXXXXXX
XXXXXXXXXXXXXXXXXXX
XXXXXXXXXXXXXXXXXXX
DEL
90^2
*
XXXXXXXXXXXXXXXXXXX
XXXXXXXXXXXXXXXXXXX
REP
90
1
v90,if p(v54) and &uf('Av54^C#1')='' and v90^2='' then '^21' fi
XXXXXXXXXXXXXXXXXXX
FI
XXXXXXXXXXXXXXXXXXX
XXXXXXXXXXXXXXXXXXX
XXXXXXXXXXXXXXXXXXX
XXXXXXXXXXXXXXXXXXX
// случай БОЛЕЕ одного места обучения
IF
if val(&uf('+N90'))>1 then '1' fi
XXXXXXXXXXXXXXXXXXX
XXXXXXXXXXXXXXXXXXX
XXXXXXXXXXXXXXXXXXX
//...........нет ли отчисления с данного фак-та
DEL
1090
*
XXXXXXXXXXXXXXXXXXX
XXXXXXXXXXXXXXXXXXX
ADD
1090
XXXXXXXXXXXXXXXXXXX
mpu,(v90/)
XXXXXXXXXXXXXXXXXXX
DEL
90
*
XXXXXXXXXXXXXXXXXXX
XXXXXXXXXXXXXXXXXXX
REPEAT
XXXXXXXXXXXXXXXXXXX
XXXXXXXXXXXXXXXXXXX
XXXXXXXXXXXXXXXXXXX
XXXXXXXXXXXXXXXXXXX
DEL
1054
*
XXXXXXXXXXXXXXXXXXX
XXXXXXXXXXXXXXXXXXX
ADD
1054
XXXXXXXXXXXXXXXXXXX
mpu,(v54/),&uf('+7W10#')
XXXXXXXXXXXXXXXXXXX
REPEAT
XXXXXXXXXXXXXXXXXXX
XXXXXXXXXXXXXXXXXXX
XXXXXXXXXXXXXXXXXXX
XXXXXXXXXXXXXXXXXXX
// проверка отчисления -в G10 отчисленные
ADD
1054
XXXXXXXXXXXXXXXXXXX
if &uf('Av1054^C#1')='' and &uf('Av1054^F#1')='' and &uf('Av1054^S#1')='' or &uf('Av1054^C#1')=''  and &uf('Av1054^S#1')<>'' and &uf('Av1054^S#1')=&uf('Av1090^C#1') and &uf('Av1054^F#1')='' or &uf('Av1054^C#1')=''  and &uf('Av1054^F#1')<>'' and &uf('Av1054^F#1')=&uf('Av1090^A#1') and &uf('Av1054^S#1')='' or &uf('Av1054^C#1')='' and &uf('Av1054^F#1')<>'' and &uf('Av1054^S#1')<>'' and &uf('Av1054^F#1')=&uf('Av1090^A#1') and &uf('Av1054^S#1')=&uf('Av1090^C#1') then &uf('+7W10#',&uf('Av1054#1')) fi
XXXXXXXXXXXXXXXXXXX
DEL
1054
1
XXXXXXXXXXXXXXXXXXX
XXXXXXXXXXXXXXXXXXX
UNTIL
if p(v1054) then '1' fi
XXXXXXXXXXXXXXXXXXX
XXXXXXXXXXXXXXXXXXX
XXXXXXXXXXXXXXXXXXX
//...........нет ли восстановления с данного фак-та
ADD
1054
XXXXXXXXXXXXXXXXXXX
(v54/),&uf('+7W11#')
XXXXXXXXXXXXXXXXXXX
REPEAT
XXXXXXXXXXXXXXXXXXX
XXXXXXXXXXXXXXXXXXX
XXXXXXXXXXXXXXXXXXX
XXXXXXXXXXXXXXXXXXX
// проверка восстановления - в G11 восстановленные
ADD
1054
XXXXXXXXXXXXXXXXXXX
if &uf('Av1054^C#1')<>'' and &uf('Av1054^F#1')='' and &uf('Av1054^S#1')='' or &uf('Av1054^C#1')<>'' and &uf('Av1054^F#1')<>'' and &uf('Av1054^F#1')=&uf('Av1090^A#1') and &uf('Av1054^S#1')='' or &uf('Av1054^C#1')<>'' and &uf('Av1054^S#1')<>'' and &uf('Av1054^S#1')=&uf('Av1090^C#1') and &uf('Av1054^F#1')='' or &uf('Av1054^C#1')<>'' and &uf('Av1054^F#1')<>'' and &uf('Av1054^S#1')<>'' and &uf('Av1054^F#1')=&uf('Av1090^A#1') and &uf('Av1054^S#1')=&uf('Av1090^C#1') then &uf('+7W11#',&uf('Av1054#1')) fi
XXXXXXXXXXXXXXXXXXX
DEL
1054
1
XXXXXXXXXXXXXXXXXXX
XXXXXXXXXXXXXXXXXXX
UNTIL
if p(v1054) then '1' fi
XXXXXXXXXXXXXXXXXXX
XXXXXXXXXXXXXXXXXXX
XXXXXXXXXXXXXXXXXXX
//............сравнение дат отчисления и восстановления
IF
if G10<>'' and G11<>'' and val(G10)-val(G11)>0 or G10<>'' and G11='' then '1' fi
XXXXXXXXXXXXXXXXXXX
XXXXXXXXXXXXXXXXXXX
XXXXXXXXXXXXXXXXXXX
REP
1090
1
&uf('Av1090#1'),if &uf('Av1090^2#1')='' then '^21' fi
XXXXXXXXXXXXXXXXXXX
FI
XXXXXXXXXXXXXXXXXXX
XXXXXXXXXXXXXXXXXXX
XXXXXXXXXXXXXXXXXXX
XXXXXXXXXXXXXXXXXXX
IF
if G10<>'' and G11<>'' and val(G11)-val(G10)>0 or G11<>'' and G10='' then '1' fi
XXXXXXXXXXXXXXXXXXX
XXXXXXXXXXXXXXXXXXX
XXXXXXXXXXXXXXXXXXX
DEL
1090^2
1
XXXXXXXXXXXXXXXXXXX
XXXXXXXXXXXXXXXXXXX
FI
XXXXXXXXXXXXXXXXXXX
XXXXXXXXXXXXXXXXXXX
XXXXXXXXXXXXXXXXXXX
XXXXXXXXXXXXXXXXXXX
//...............................
ADD
90
XXXXXXXXXXXXXXXXXXX
&uf('Av1090#1')
XXXXXXXXXXXXXXXXXXX
DEL
1090
1
XXXXXXXXXXXXXXXXXXX
XXXXXXXXXXXXXXXXXXX
UNTIL
if p(v1090) then '1' fi
XXXXXXXXXXXXXXXXXXX
XXXXXXXXXXXXXXXXXXX
XXXXXXXXXXXXXXXXXXX
//...................
// конец случай БОЛЕЕ одного места обучения
FI
XXXXXXXXXXXXXXXXXXX
XXXXXXXXXXXXXXXXXXX
XXXXXXXXXXXXXXXXXXX
XXXXXXXXXXXXXXXXXXX
// конец есть поле 54
FI
XXXXXXXXXXXXXXXXXXX
XXXXXXXXXXXXXXXXXXX
XXXXXXXXXXXXXXXXXXX
XXXXXXXXXXXXXXXXXXX
// удаление дисциплины из поля 69, если есть признак отчисления
IF
if v90: '^21' then '1' fi
XXXXXXXXXXXXXXXXXXX
XXXXXXXXXXXXXXXXXXX
XXXXXXXXXXXXXXXXXXX
ADD
1090
XXXXXXXXXXXXXXXXXXX
(v90/)
XXXXXXXXXXXXXXXXXXX
REPEAT
XXXXXXXXXXXXXXXXXXX
XXXXXXXXXXXXXXXXXXX
XXXXXXXXXXXXXXXXXXX
XXXXXXXXXXXXXXXXXXX
IF
if &uf('Av1090^2#1')<>'' then '1' fi
XXXXXXXXXXXXXXXXXXX
XXXXXXXXXXXXXXXXXXX
XXXXXXXXXXXXXXXXXXX
DEL
69
F
(if p(v69) then if s(&uf('7VUZ,?IDV=',v69^D,'?,v68^A,v68^C')): s(&uf('Av1090^A#1'),,&uf('Av1090^C#1'),,,) then '1' else '0' fi fi/)
XXXXXXXXXXXXXXXXXXX
FI
XXXXXXXXXXXXXXXXXXX
XXXXXXXXXXXXXXXXXXX
XXXXXXXXXXXXXXXXXXX
XXXXXXXXXXXXXXXXXXX
DEL
1090
1
XXXXXXXXXXXXXXXXXXX
XXXXXXXXXXXXXXXXXXX
UNTIL
if p(v1090) then '1' fi
XXXXXXXXXXXXXXXXXXX
XXXXXXXXXXXXXXXXXXX
XXXXXXXXXXXXXXXXXXX
IF
if s(v69|,|)<>s(v1070|,|) then '1' fi
XXXXXXXXXXXXXXXXXXX
XXXXXXXXXXXXXXXXXXX
XXXXXXXXXXXXXXXXXXX
PUTLOG
'LinkRdr: Отчислен/Восстановлен: изменены дисциплины (',v30,'). MFN=',f(val(mfn),0,0)
XXXXXXXXXXXXXXXXXXX
XXXXXXXXXXXXXXXXXXX
XXXXXXXXXXXXXXXXXXX
FI
XXXXXXXXXXXXXXXXXXX
XXXXXXXXXXXXXXXXXXX
XXXXXXXXXXXXXXXXXXX
XXXXXXXXXXXXXXXXXXX
// конец v90: ^21
FI
XXXXXXXXXXXXXXXXXXX
XXXXXXXXXXXXXXXXXXX
XXXXXXXXXXXXXXXXXXX
XXXXXXXXXXXXXXXXXXX
//=======================================
DEL
1090
*
XXXXXXXXXXXXXXXXXXX
XXXXXXXXXXXXXXXXXXX
DEL
1069
*
XXXXXXXXXXXXXXXXXXX
XXXXXXXXXXXXXXXXXXX
DEL
1070
*
XXXXXXXXXXXXXXXXXXX
XXXXXXXXXXXXXXXXXXX
