0
// задание REPDISC запускается из REPMARK1
//16 - поле 991 в цикле
//12 PUTFLD
//замена имени дисциплины
// замена идентификатора, цикла, кафедоы, УК
//в 991^A что заменить, 991^B на что 
// 991^I - идент.дисц в случае замены цикла, КАФЕДРЫ, НАИМЕНОВАНИЯ -при замене проверка по ИД дисциплины
//------------------------------------------------------цикл по полям 991
REPEAT
//--------------------------------------наименование
DEL
111
*


ADD
111

(v691^D/)

REP
691^D
F
(if p(v691) then if p(v691^D) then if &uf('+97',v691^I)=&uf('+97',&uf('Av991^I#1')) then if &uf('+97',v691^D)=&uf('+97',&uf('Av991^A#1')) then &uf('Av991^B#1') else v691^D fi else v691^D fi else # fi fi/)

IF
if v111<>v691^D then '1' fi
PUTLOG
'Имя заменен в записи каталога ',&uf('+D'),'. MFN=',,,f(val(mfn),0,0),,' для дисциплины ',,&uf('Av991^I#1')
FI
DEL
111
*


IF
if v991^C: 'I' then '1' fi
//--------------------------------------идентификатор
DEL
111
*


ADD
111

(v691^I/)

REP
691^I
F
(if p(v691) then if p(v691^I) then if &uf('+97',v691^I)=&uf('+97',&uf('Av991^A#1')) then &uf('Av991^B#1') else v691^I fi else # fi fi/)

IF
if v111<>v691^I then '1' fi
PUTLOG
'ИД заменен в записи каталога ',&uf('+D'),'. MFN=',,,f(val(mfn),0,0),,' для дисциплины ',,&uf('Av991^I#1')
FI
DEL
111
*


FI
IF
if v991^C: 'S' then '1' fi
//--------------------------------------цикл
DEL
111
*


ADD
111

(v691^S/)

REP
691^S
F
(if p(v691) then if p(v691^S) then if &uf('+97',v691^S)=&uf('+97',&uf('Av991^A#1')) and &uf('+97',v691^I)=&uf('+97',&uf('Av991^I#1')) then &uf('Av991^B#1') else v691^S fi else # fi fi/)

REP
691
F
(if p(v691) then v691,,if a(v691^S) and &uf('Av991^B#1')<>'' then '^S',&uf('Av991^B#1') fi fi/)

IF
if v111<>v691^S then '1' fi
PUTLOG
'Цикл заменен в записи каталога ',,&uf('+D'),,'. MFN=',f(val(mfn),0,0),,' для дисциплины ',,&uf('Av991^I#1')
FI
DEL
111
*


FI
IF
if v991^C: 'B' then '1' fi
//-------------------------------------кафедра
DEL
111
*


ADD
111

(v691^B/)

REP
691^B
F
(if p(v691) then if p(v691^B) then if &uf('+97',v691^B)=&uf('+97',&uf('Av991^A#1')) and &uf('+97',v691^I)=&uf('+97',&uf('Av991^I#1')) then &uf('Av991^B#1') else v691^B fi else # fi fi/)

REP
691
F
(if p(v691) then v691,,if a(v691^B) and &uf('Av991^B#1')<>'' then '^B',&uf('Av991^B#1') fi fi/)

IF
if v111<>v691^B then '1' fi
PUTLOG
'Кафедра заменена в записи каталога ',&uf('+D'),'. MFN=',,,f(val(mfn),0,0),,' для дисциплины ',,&uf('Av991^I#1')
FI
DEL
111
*


FI
IF
if v991^C: 'K' then '1' fi
//--------------------------------------уровень компоненты
DEL
111
*


ADD
111

(v691^K/)

REP
691^K
F
(if p(v691) then if p(v691^K) then if &uf('+97',v691^K)=&uf('+97',&uf('Av991^A#1')) and &uf('+97',v691^I)=&uf('+97',&uf('Av991^I#1')) then &uf('Av991^B#1') else v691^K fi else # fi fi/)

REP
691
F
(if p(v691) then v691,,if a(v691^K) and &uf('Av991^B#1')<>'' then '^K',&uf('Av991^B#1') fi fi/)

IF
if v111<>v691^K then '1' fi
PUTLOG
'УК заменен в записи каталога ',&uf('+D'),'. MFN=',,,f(val(mfn),0,0),,' для дисциплины ',,&uf('Av991^I#1')
FI
DEL
111
*


FI
DEL
991
1


UNTIL
if p(v991) then '1' fi
DEL
991
*


