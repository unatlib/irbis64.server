1
CreateWPDVuz.wss

//формирование записей РП по полю 691^5
DEL
991
*


ADD
991

'%1',,,&uf('+7W10#',,,(if p(v691^5) then v691^I fi/)  ),,,,&uf('+7G10')

REPEAT
DEL
111
*


ADD
111

&uf('Ag10#1')

IF
if val(&uf('JVUZ,WPD=',,'РП-',,&uf('Ag10#1')  ))<=0 then '1' fi
// записи WPD нет - создаю
NEWMFN
'VUZ'
ADD
110

'РП-',,&uf('Ag10#1')

ADD
83

&uf('Ag10#1')

ADD
205

&uf('Av991^A#1')

ADD
5

&uf('Av991^B#1')

ADD
6

&uf('Av991^C#1')

ADD
701

if &uf('Av991^D#1')<>'' then '^A',&uf('Av991^D#1') fi,,,if &uf('Av991^E#1')<>'' then '^B',&uf('Av991^E#1') fi

ADD
920

'WPD'

END
FI
DEL
1691
1


UNTIL
if p(v1691) then '1' fi
