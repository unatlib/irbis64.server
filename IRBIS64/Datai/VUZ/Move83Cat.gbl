1
if val(&uf('IMAIN,ReaderMode,0'))=0 then 'Move83Cat.wss' else 'MoveZak.wss' fi
  ВВЕДИТЕ данные для переноса
//12 PUTLOG
// 11.1
// перенос полей ВСЕХ КОНТИНГЕНТОВ из дисциплин, поля 83 в поле 691 каталога
// в поле 991 поля 83 из записи DISC
// переносимые строки в 991, в 992^A признак осн/доп, в 992^B признак по рабочей программе
DEL
932
*


DEL
1932
*


ADD
1932

(if p(v991) then v991,,if &unifor('Av992^A#1')<>'' then '^G',&unifor('Av992^A#1') fi,,,,if val(&unifor('Av992^B#1'))>0 then '^5',&unifor('Av992^B#1') fi,,,,'^4',,&unifor('3'),,'-MV-',,&uf('IPRIVATE,FIO,')  fi/)

//------------- размножение по семестрам -> в поле 932
REPEAT
XXXXXXXXXXXXXXXXXXX
XXXXXXXXXXXXXXXXXXX
XXXXXXXXXXXXXXXXXXX
XXXXXXXXXXXXXXXXXXX
ADD
932
XXXXXXXXXXXXXXXXXXX
mpu,if &unifor('Av1932^f#1'):'/' then (if &unifor('1*R/?v1932^f#1')<>''then if &unifor('Av1932^L#1')<>'' then '^L',&unifor('Av1932^L#1') fi,,if &unifor('Av1932^T#1')<>'' then '^T',&unifor('Av1932^T#1') fi,,if &unifor('Av1932^H#1')<>'' then '^H',&unifor('Av1932^H#1') fi,if &unifor('Av1932^N#1')<>'' then '^N',&unifor('Av1932^N#1') fi,if &unifor('Av1932^C#1')<>'' then '^C',&unifor('Av1932^C#1') fi,if &unifor('Av1932^A#1')<>'' then '^A',&unifor('Av1932^A#1') fi,if &unifor('Av1932^V#1')<>'' then '^V',&unifor('Av1932^V#1') fi,if &unifor('Av1932^O#1')<>'' then '^O',&unifor('Av1932^O#1') fi,,if &unifor('Av1932^G#1')<>'' then '^G',&unifor('Av1932^G#1') fi,,if &unifor('Av1932^B#1')<>'' then '^B',&unifor('Av1932^B#1') fi,,if &unifor('Av1932^S#1')<>'' then '^S',&unifor('Av1932^S#1') fi,,if &unifor('Av1932^E#1')<>'' then '^E',&unifor('Av1932^E#1') fi,,if &unifor('Av1932^K#1')<>'' then '^K',&unifor('Av1932^K#1') fi,,,if &unifor('Av1932^5#1')<>'' then '^5',&unifor('Av1932^5#1') fi  if &unifor('Av1932^I#1')<>'' then '^I',&unifor('Av1932^I#1') fi  if &unifor('Av1932^5#1')<>'' then '^I',&unifor('Av1932^5#1') fi  if &unifor('Av1932^4#1')<>'' then '^4',&unifor('Av1932^4#1') fi   '^F',&unifor('1*R/?v1932^f#1'),, fi/) else &unifor('Av1932#1') fi,,,
XXXXXXXXXXXXXXXXXXX
REP
932
F
(if p(v932) then v932,if v932^I='' then if &unifor('Av991^I#1')<>'' then '^I',&unifor('Av991^I#1') fi fi,,,if v932^D='' then if v932^I<>'' then '^D',,&uf('DVUZ,?IDD=',,v932^I,,,'?,v3^A') fi fi fi/)
XXXXXXXXXXXXXXXXXXX
DEL
1932
1
XXXXXXXXXXXXXXXXXXX
XXXXXXXXXXXXXXXXXXX
UNTIL
if p(v1932)then'1'else''fi
XXXXXXXXXXXXXXXXXXX
XXXXXXXXXXXXXXXXXXX
XXXXXXXXXXXXXXXXXXX
//-------------------------------- ЦИКЛ ПО ПОВТОРЕНИЯМ ПОЛЯ 991, которые развернуты в 932
//------------- сначала заменяю подполя 691 на подполя из 932
/* повторение идент-ся по: A-L-V-O-C-N-F-I
/* заменяются: G-D-H-B-S-K-E-5-4
DEL
111
*


ADD
111

(v932/)

DEL
112
*


ADD
112

(v691/)

REPEAT
XXXXXXXXXXXXXXXXXXX
XXXXXXXXXXXXXXXXXXX
XXXXXXXXXXXXXXXXXXX
XXXXXXXXXXXXXXXXXXX
REP
691
F
(if p(v691) then  if  &uf('+97',v691^A)=&uf('Av111^A#1') and &uf('+97',v691^L)=&uf('Av111^L#1') and  &uf('+97',v691^V)=&uf('Av111^V#1') and &uf('+97',v691^O)=&uf('Av111^O#1')  and &uf('+97',v691^C)=&uf('Av111^C#1')  and &uf('+97',v691^N)=&uf('Av111^N#1')  and v691^F=&unifor('Av111^F#1') and &uf('+97',v691^I)=&uf('Av111^I#1')   then |^I|v691^I,,|^A|v691^A,,|^L|v691^L,,|^V|v691^V,,|^O|v691^O,,|^C|v691^C,,|^N|v691^N,,|^F|v691^F,,,,,,,if &uf('Av111^G#1')<>'' then '^G',&uf('Av111^G#1') else |^G|v691^G fi,,,if &uf('Av111^D#1')<>'' then '^D',&uf('Av111^D#1') else |^D|v691^D fi,,if &uf('Av111^H#1')<>'' then '^H',&uf('Av111^H#1') else |^H|v691^H fi,,if &uf('Av111^B#1')<>'' then '^B',&uf('Av111^B#1') else |^B|v691^B fi,,if &uf('Av111^S#1')<>'' then '^S',&uf('Av111^S#1') else |^S|v691^S fi,,if &uf('Av111^K#1')<>'' then '^K',&uf('Av111^K#1') else |^K|v691^K fi,,if &uf('Av111^E#1')<>'' then '^E',&uf('Av111^E#1') else |^E|v691^E fi,,if &uf('Av111^5#1')<>'' then '^5',&uf('Av111^5#1') else |^5|v691^5 fi,,,,if &uf('Av111^4#1')<>'' then '^4',&uf('Av111^4#1') fi,,,,,,,,,,,,,,,,else v691 fi fi/)

DEL
111
1


UNTIL
if p(v111) then '1' fi
IF
if v112<>v691 then '1' fi
PUTLOG
'Замена в поле 691. MFN=',f(val(mfn),0,0)
FI
//----------добавляю новые поваторения из 932, сначала в 1691
DEL
1691
*


REPEAT
XXXXXXXXXXXXXXXXXXX
XXXXXXXXXXXXXXXXXXX
XXXXXXXXXXXXXXXXXXX
XXXXXXXXXXXXXXXXXXX
//--------новое повторене
//------- идентификация - уже есть по: A-L-V-O-C-N-F-I
ADD
1691

if rsum((if p(v691) then if &uf('+97',v691^A)=&uf('+97',&unifor('Av932^A#1')) then if &uf('+97',v691^L)=&uf('+97',&unifor('Av932^L#1')) then if &uf('+97',v691^V)=&uf('+97',&unifor('Av932^V#1')) then if &uf('+97',v691^O)=&uf('+97',&unifor('Av932^O#1')) then if &uf('+97',v691^C)=&uf('+97',&unifor('Av932^C#1')) then if  &uf('+97',v691^N)=&uf('+97',&unifor('Av932^N#1')) then if       val(v691^F)=val(&unifor('Av932^F#1')) then if       &uf('+97',v691^I)=&uf('+97',&unifor('Av932^I#1')) then '1,' else '0,' fi fi fi fi fi fi fi fi fi))=0 then &unifor('Av932#1'),,,,, fi

DEL
932
1


UNTIL
if p(v932) then '1' fi
IF
if p(v1691) then '1' fi
ADD
691

(v1691/)

DEL
1691
*


PUTLOG
'Добавлены повторения поля 691. MFN=',f(val(mfn),0,0)
FI
DEL
991
*


DEL
992
*


DEL
994
*


DEL
932
*


DEL
1932
*


DEL
1691
*


DEL
111
*


DEL
112
*


