0
IF
if p(v991^c) then '1' fi
XXXXXXXXXXXXXXXXXXX
XXXXXXXXXXXXXXXXXXX
XXXXXXXXXXXXXXXXXXX
DEL
932
*
XXXXXXXXXXXXXXXXXXX
XXXXXXXXXXXXXXXXXXX
//
XXXXXXXXXXXXXXXXXXX
XXXXXXXXXXXXXXXXXXX
 в 1932* - вводим порядковые номера отобранных ПОЛЕЙ 330. В g933 будут собираться шифры новых записей

ADD
1932
XXXXXXXXXXXXXXXXXXX
&uf('+7W33#'),if p(v991^c) then (if &uf('1*R,?v991^c#1')<>'' then &uf('1*R,?v991^c#1') fi/) fi,

XXXXXXXXXXXXXXXXXXX
//
XXXXXXXXXXXXXXXXXXX
XXXXXXXXXXXXXXXXXXX
 Удаляем поля 933 с шифрами новых записей, созданных при предыдущем выполнении

DEL
933
*
XXXXXXXXXXXXXXXXXXX
XXXXXXXXXXXXXXXXXXX
//
XXXXXXXXXXXXXXXXXXX
XXXXXXXXXXXXXXXXXXX
 в 933* - вводим отобранные ПОЛЯ 330 по их номерам в поле 1932

ADD
933
XXXXXXXXXXXXXXXXXXX
(if p(v1932) then &uf('Av330#'v1932) fi/),&uf('+7w33#'(if p(v330) then if f(val(v330^0),0,0)=v330^0 then |^0|v330^0,|^C|v330^c,|^N|v330^n fi fi/)),
XXXXXXXXXXXXXXXXXXX
DEL
1932
*
XXXXXXXXXXXXXXXXXXX
XXXXXXXXXXXXXXXXXXX
REPEAT
XXXXXXXXXXXXXXXXXXX
XXXXXXXXXXXXXXXXXXX
XXXXXXXXXXXXXXXXXXX
XXXXXXXXXXXXXXXXXXX
ADD
932
XXXXXXXXXXXXXXXXXXX
&uf('Av933#1'),if &uf('Av933^M#1')<>'' then '^Z1' fi
XXXXXXXXXXXXXXXXXXX
REPEAT
XXXXXXXXXXXXXXXXXXX
XXXXXXXXXXXXXXXXXXX
XXXXXXXXXXXXXXXXXXX
XXXXXXXXXXXXXXXXXXX
NEWMFN
'*'
XXXXXXXXXXXXXXXXXXX
XXXXXXXXXXXXXXXXXXX
XXXXXXXXXXXXXXXXXXX
ADD
972
XXXXXXXXXXXXXXXXXXX
"^0"v932^0,"."v932^z,if v932^m<>'' then '^A???' else "^A"v932^c,(if p(g33) then if &uf('Av932^0#1'):'.' then if g33^0=&uf('G0.'&uf('Av932^0#1')) then |^B|g33^c fi fi fi) fi  
XXXXXXXXXXXXXXXXXX
ADD
33
XXXXXXXXXXXXXXXXXXX
if v932^z<>'' then "^0"v932^c else (if p(g33) then if &uf('Av932^0#1'):'.' then if g33^0=&uf('G0.'&uf('Av932^0#1')) then |^0|g33^c fi fi fi) fi
XXXXXXXXXXXXXXXXXXX
ADD
920
XXXXXXXXXXXXXXXXXXX
'event'
XXXXXXXXXXXXXXXXXXX
ADD
900
XXXXXXXXXXXXXXXXXXX
"^A"v932^t,if v932^z<>'' then"^C"v932^x,"^CC"n932^x fi
XXXXXXXXXXXXXXXXXXX
ADD
903
XXXXXXXXXXXXXXXXXXX
&uf('+7W1#'),&uf('+7W1#'v932^t'-'&unifor('R5')),g1,&uf('+7U933#'g1)
XXXXXXXXXXXXXXXXXXX
ADD
30
XXXXXXXXXXXXXXXXXXX
if v932^m<>'' then else "^A"v932^a,"^B"v932^b fi
XXXXXXXXXXXXXXXXXXX
ADD
31
XXXXXXXXXXXXXXXXXXX
if v932^m<>'' then else "^A"v932^x,"^B"v932^y fi
XXXXXXXXXXXXXXXXXXX
ADD
210
XXXXXXXXXXXXXXXXXXX
"^E"v932^d
XXXXXXXXXXXXXXXXXXX
ADD
304
XXXXXXXXXXXXXXXXXXX
"^A"v932^n
XXXXXXXXXXXXXXXXXXX
ADD
331
XXXXXXXXXXXXXXXXXXX
(v331/)
XXXXXXXXXXXXXXXXXXX
ADD
711
XXXXXXXXXXXXXXXXXXX
(v711/)
XXXXXXXXXXXXXXXXXXX
ADD
488
XXXXXXXXXXXXXXXXXXX
v488/'^12','^W'v903,|^A|v200^a,if p(v200^b) then &uf('+7W1#'&uf('G0-'v200^b)),&uf('+7W2#'&uf('G2-'v200^b)),' на 'if g1*4=''then ' 'g1' г.'else g1*6' ',if g1*6='' then &uf('36'g1*4.2) else &uf('37'g1*4.2) fi,if g1.4=g2.4 then else ' 'g1.4| года| fi,if v200^b:'-' then' - 'g2*6' ',if g2*6='' then &uf('36'g2*4.2) else &uf('37'g2*4.2) fi ' 'g2.4| года| fi fi else " "v200^c fi,'^#'&uf('+D'),
XXXXXXXXXXXXXXXXXXX
ADD
711
XXXXXXXXXXXXXXXXXXX
|^A|v932^n,if a(v932^n) then (if p(g33) then if &uf('Av932^0#1'):'.' then if g33^0=&uf('G0.'&uf('Av932^0#1')) then |^A|g33^n|^4570 орг.| fi fi fi) fi
XXXXXXXXXXXXXXXXXXX
END
XXXXXXXXXXXXXXXXXXX
XXXXXXXXXXXXXXXXXXX
XXXXXXXXXXXXXXXXXXX
XXXXXXXXXXXXXXXXXXX
//
XXXXXXXXXXXXXXXXXXX
XXXXXXXXXXXXXXXXXXX
 Повторяем создание ТОЙ ЖЕ новой записи, если в 932^M введено число 

IF
if v932^M<>'' then '1'else '0' fi
XXXXXXXXXXXXXXXXXXX
XXXXXXXXXXXXXXXXXXX
XXXXXXXXXXXXXXXXXXX
CHA
932^M
1
v932^M
f(val(v932^M)-1,0,0)
CHA
932^Z
1
v932^Z
f(val(v932^Z)+1,0,0)
UNTIL
if val(v932^M)>0 then '1' else '0' fi
XXXXXXXXXXXXXXXXXXX
XXXXXXXXXXXXXXXXXXX
XXXXXXXXXXXXXXXXXXX
FI
XXXXXXXXXXXXXXXXXXX
XXXXXXXXXXXXXXXXXXX
XXXXXXXXXXXXXXXXXXX
XXXXXXXXXXXXXXXXXXX
DEL
932
1
XXXXXXXXXXXXXXXXXXX
XXXXXXXXXXXXXXXXXXX
DEL
933
1
XXXXXXXXXXXXXXXXXXX
XXXXXXXXXXXXXXXXXXX
UNTIL
if p(v933) then '1' else '0' fi
XXXXXXXXXXXXXXXXXXX
XXXXXXXXXXXXXXXXXXX
XXXXXXXXXXXXXXXXXXX
ADD
933
XXXXXXXXXXXXXXXXXXX
'^N'g933|;|,'^K'f(rsum((if g933<>'' then '1;'fi)),0,0)
XXXXXXXXXXXXXXXXXXX
FI
XXXXXXXXXXXXXXXXXXX
XXXXXXXXXXXXXXXXXXX
XXXXXXXXXXXXXXXXXXX
XXXXXXXXXXXXXXXXXXX
